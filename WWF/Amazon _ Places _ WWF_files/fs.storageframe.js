/***************************************
* @license
* ForeSee Client Code: Storage Frame
* http://www.answers.com/page/businesssolutions
* Built January 19, 16 10:02:06
* Version: 0.8.8
***************************************/
var utils={};utils.eitherOr=function(t,e,i){return t[e]||t[i]},utils.isDefined=function(t){return null!==t&&"undefined"!=typeof t},utils.isFunction=function(t){return"function"==typeof t},utils.isObject=function(t){return"object"==typeof t},utils.isArr=function(t){return"[object Array]"==Object.prototype.toString.call(t)},utils.escapeRegExp=function(t){return t.toString().replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},utils.trim=function(t){return t.toString().replace(/\s+/g," ").replace(/^\s+|\s+$/g,"")},utils.proxy=function(t,e){var i,s,n=Function.prototype.bind,r=Array.prototype.slice;return n&&t.bind===n?n.apply(t,r.call(arguments,1)):(i=r.call(arguments,2),s=function(){if(!(this instanceof s))return t.apply(e,i.concat(r.call(arguments)));ctor.prototype=t.prototype;var n=ctor();ctor.prototype=null;var o=t.apply(n,i.concat(r.call(arguments)));return Object(o)===o?o:n})},utils.superDispose=function(t){if(t){if(t.length)for(var e=t.length-1;e>=0;e--)t[e]=null;for(var i in t){var s=typeof t[i];("function"==s||"object"==s)&&(t[i]=null)}}t=null},utils.ext=function(){var t,e,i,s=arguments,n=s[0]||{},r=1,o=arguments.length;for("object"==typeof n||utils.isFunction(n)||(n={}),o===r&&(n=this,--r);o>r;r++)if(utils.isDefined(t=s[r]))for(e in t)i=t[e],n!==i&&void 0!==i&&(n[e]=i);return n},utils.toQueryString=function(t,e){e=e||"";var i=e+(e.indexOf("?")>-1?"&":"?");if(t)for(var s in t)i+=encodeURIComponent(s)+"="+encodeURIComponent(t[s])+"&";return i},utils.copyIfDefined=function(t,e,i){for(var s,n=t.split("."),r=e[utils.shift(n)],o=i;utils.isDefined(r)&&n.length>0;)r=r[utils.shift(n)];if(r){for(n=t.split(".");n.length&&(s=utils.shift(n));)o=o[s]?o[s]:o[s]={};for(n=t.split("."),o=i;n.length&&(s=utils.shift(n));)n.length>0?o=o[s]:o[s]=r}},utils.merge=function(){for(var t={},e=arguments,i=0,s=e.length;s>i;i++){var n=e[i];if(utils.isPlainObject(n))for(var r in n){var o=n[r],a=t[r];t[r]=a&&utils.isPlainObject(o)&&utils.isPlainObject(a)?utils.merge(a,o):utils.unlink(o)}}return t},utils.unlink=function(t){var e;if(utils.isPlainObject(t)){e={};for(var i in t)e[i]=utils.unlink(t[i])}else if(utils.isArr(t)){e=[];for(var s=0,n=t.length;n>s;s++)e[s]=utils.unlink(t[s])}else e=t;return e},utils.isPlainObject=function(t){if(!t||"[object Object]"!==Object.prototype.toString.call(t)||t.nodeType||t.setInterval)return!1;if(t.constructor&&!hasOwnProperty.call(t,"constructor")&&!hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1;var e;for(e in t);return void 0===e||hasOwnProperty.call(t,e)||!hasOwnProperty.call(t,e)&&hasOwnProperty.call(Object.prototype,e)},utils.hashCode=function(t){var e,i=0,s="";if(0===t.length)return i;for(e=0;e<t.length;e++)s=t.charCodeAt(e),i=(i<<5)-i+s,i&=i;return i};var bindings={};utils.preventDefault=function(t){t&&t.preventDefault?t.preventDefault():window.event&&window.event.returnValue?window.eventReturnValue=!1:t.returnValue=!1},utils.unloadList=[],utils.Bind=function(t,e,i,s){if(t){if(bindings[e]||(bindings[e]=[]),bindings[e].push({elem:t,cb:i}),"unload"==e)return void utils.unloadList.push(i);"propertychange"!=e&&t.addEventListener?t.addEventListener(e,i,!s):t.attachEvent&&t.attachEvent("on"+e,i)}},utils.BindWithBubble=function(t,e,i){utils.Bind(t,e,i,!0)},utils.Unbind=function(t,e,i,s){try{"propertychange"!=e&&t.removeEventListener?t.removeEventListener(e,i,!s):t.detachEvent&&t.detachEvent("on"+e,i)}catch(n){}},utils.HandleUnload=function(){for(var t=utils.unloadList.length-1;t>=0;t--)try{utils.unloadList[t].call()}catch(e){}utils.superDispose(utils.unloadList),utils.ReleaseAllBindings(),utils.dispose()},utils.Bind(window,"unload",utils.HandleUnload),utils.ReleaseAllBindings=function(){for(var t in eu.Bindings)if(utils.Bindings.hasOwnProperty(t)){for(var e=utils.Bindings[t],i=e.pop();i;)utils.Unbind(i.elem,t,i.cb),utils.superDispose(i),i=e.pop();delete eu.Bindings[t]}},utils.FSEvent=function(){this.subscriptions=[],this.didFire=!1},utils.FSEvent.prototype.subscribe=function(t,e,i){this.subscriptions[this.subscriptions.length]={once:e||i||!1,cb:t},i&&this.didFire&&this.fire()},utils.FSEvent.prototype.unsubscribe=function(t){for(var e=0;e<this.subscriptions.length;e++)this.subscriptions[e].cb==t&&(this.subscriptions.splice(e,1),e--)},utils.FSEvent.prototype.unsubscribeAll=function(){this.subscriptions=[]},utils.FSEvent.prototype.fire=function(){this.didFire=!0;for(var t=0;t<this.subscriptions.length;t++){var e=this.subscriptions[t];e.cb.apply(this,arguments),e.once&&(this.subscriptions.splice(t,1),t--)}},utils.FULL_DAY=864e5,utils.now=function(){return+new Date},utils.startTime=utils.now();var FrameController=function(t){this.br=t,this._namespaces={},this.securityError=new utils.FSEvent,this.securityError.subscribe(utils.proxy(function(){this._postMessage("securityerror",{})},this),!0),this.cm=new Comms(t),this.cm.securityError.subscribe(utils.proxy(function(){this.securityError.fire()},this),!0),this._lastTrackerMsg={when:0,msg:""},utils.Bind(window,"message",utils.proxy(function(t){this._onMessage(t)},this),"*"),this._postMessage("ready",{}),setInterval(function(t){return function(){t._postMessage("ready",{})}}(this),250),setInterval(function(t){return function(){t._checkTrackerMsgs()}}(this),500)};FrameController.prototype._checkTrackerMsgs=function(){var t=this.cm.get("trkmsg"),e=this.cm.get("trkmsgts");this.cm.kill("trkmsg"),this.cm.kill("trkmsgts"),t&&e&&(e=parseInt(e,10),this._lastTrackerMsg.when<e&&(this._lastTrackerMsg.when=e,this._lastTrackerMsg.trkmsg=t,this._postMessage("trackermsg",t)))},FrameController.prototype._onMessage=function(t){var e;try{e=JSON.parse(t.data)}catch(i){return}var s=e.params.nso||e.namespace,n=e.method,r=e.params,o=r.skipencode,a=r.contenttype;if(!this._namespaces[s])try{this._namespaces[s]=JSON.parse(localStorage.getItem(s)||"{}")}catch(l){return void this.securityError.fire()}var u=this._namespaces[s];switch(n){case"set":u[r.key]=r.value,this.cm.set(s,JSON.stringify(u)),localStorage.setItem(s,JSON.stringify(u));break;case"get":this._postMessage("report",{key:r.key,value:(u[r.key]||"")+""});break;case"trackercmd":this.cm.set("trackermsg",JSON.stringify(r));break;case"ajax":var c=new utils.AjaxTransport({url:r.url,method:r.method,skipEncode:o,contentType:a,success:function(t,e){return function(t){e._postMessage("ajaxreturn",{params:r,res:t,success:!0})}}(r,this),failure:function(t,e){return function(t){e._postMessage("ajaxreturn",{params:r,success:!1,res:t})}}(r,this),data:r.data});c.send();break;case"sync":this._postMessage("syncreturn",{params:r,res:u})}},FrameController.prototype._postMessage=function(t,e){var i=JSON.stringify({src:"storageframe",method:t,params:e});window.parent.postMessage(i,"*")};var Comms=function(t){var e=t.browser;this.useAlt=t.isIE&&e.version<9||"Safari"==e.name,this._bidID=1,this._stgLimit=2e3,this._trnsInterval=30,this.altBits=[],this.securityError=new utils.FSEvent;var i,s=!1;if(this.useAlt){var n=window.location.host.toString().toLowerCase().replace(/www\./gi,"");n.indexOf(":")>-1&&(n=n.substr(0,n.indexOf(":"))),this._stg={};var r=new Date;r.setTime(r.getTime()+31536e6);var o={path:"/",domain:n,secure:!1,encode:!0,expires:r.toGMTString()};this._ck=new utils.Cookie(o),this._cktimer=setInterval(utils.proxy(function(){try{if(this.altBits.length>0){var t=this._ck.get("acsmsgrec"),e=this._ck.get("acsIce");!e||!t&&s||(s=!0,this._ck.kill("acsmsgrec"),i=JSON.stringify(this.altBits.shift()),this._ck.set("acsmsg",i))}}catch(n){clearInterval(this._cktimer),this.securityError.fire()}},this),this._trnsInterval)}};Comms.prototype.set=function(t,e){if("string"!=typeof e&&(e=JSON.stringify(e)),this._ck){this._stg[t]=e;for(var i="_"+Math.round(999999*Math.random());e.length>0;)this.altBits.push({id:this._bidID++,t:i,k:t,d:e.substr(0,Math.min(this._stgLimit,e.length)),f:e.length<=this._stgLimit}),e=e.substr(Math.min(this._stgLimit,e.length))}else try{localStorage.setItem(t,e),localStorage.setItem("acsLastMsg",utils.now())}catch(s){this.securityError.fire()}},Comms.prototype.get=function(t){try{return this._ck?this._ck.get(t):localStorage.getItem(t)}catch(e){this.securityError.fire()}},Comms.prototype.kill=function(t){try{this._ck?this._ck.kill(t):localStorage.removeItem(t)}catch(e){this.securityError.fire()}},utils.Browser=function(t,e){var i=this;i.os={name:"",version:0},i.browser={name:"",version:0,actualVersion:0},i.agent="",i.isMobile=!1,i.isTablet=!1,i.isIE=!1,i.isZoomable=!0,i.supportsSVG=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),i.isReady=!1,i.browserReady=new utils.FSEvent,i.isIos=!1,i.servUrl=location.protocol+"//device.4seeresults.com/detect?accessToken=";var s=i.agent=t||navigator.userAgent;i.isMobile=/iphone|ipad|ipod|android|kindle|silk|bntv|nook|blackberry|playbook|mini|windows\sce|windows\sphone|palm|bb10/i.test(s),i.isWinPhone=/Windows Phone/i.test(s),i.isMobile&&(/iphone|ipad|ipod/i.test(s)&&!i.isWinPhone&&(i.isIos=!0),/ipad|silk|kindle|playbook|nook|bntv/i.test(s)&&(i.isTablet=!0));var n=function(t){return s.toLowerCase().indexOf(t.toLowerCase())>-1},r=function(t,e){return"IE"!=t?e:e>6&&10>e?n("Trident")||7!=e?n("Trident/5.0")&&9>=e?9:n("Trident/4.0")&&9>e?n("WOW64")?8:7==e?e:8:e:7:e},o=function(t,e){return e?n("Windows Phone")?"Winphone":n("iPod")?"iPod":n("iPad")?"iPad":n("iPhone")?"iPhone":(n("blackberry")||n("playbook")||n("BB10"))&&n("applewebkit")?"Blackberry":n("Kindle")||n("Silk")?"Kindle":n("BNTV")||n("Nook")?"Nook":n("Android")?"Android":utils.isDefined(window.orientation)?"Mobile":"Other":n("Windows")?"Windows":n("OS X")?"Mac":n("Linux")||n("Googlebot")?"Linux":n("Mac")?"Mac":void 0},a=function(t,e){var i,s,r,o;return e?n("windows phone")||!n("ipad")&&!n("iphone")?n("googlebot")?1:(i=t.match(/Windows Phone OS[\/\s](\d+\.?\d+)/)||t.match(/Windows Phone[\/\s](\d+\.?\d+)/)||t.match(/Android[\/\s](\d+\.?\d+)/),r=utils.isDefined(i)?i[1]:1,min=parseFloat(r),!isNaN(min)&&min>0?min:r):(i=/OS ([0-9_]*) like/gi.exec(t),s=i[1].split("_"),r=parseInt(s[0]),o=parseInt(s[1]),r+o/10):1},l=function(){if("Winphone"!=i.os.name){var t=document.querySelectorAll("head meta[name=viewport],head meta[name=VIEWPORT],head meta[name=Viewport]")||[];if(utils.isArr(t)||(t=[t]),e||t.length>0){for(var s=function(t,e){var i=new RegExp("[\\w\\W]*"+e+"[\\s]*=[\\s]*([^\\s,;]*)[\\w\\W]*","i");return t?t.match(i):null},n=0;n<t.length;n++){var r=e||t[n].content,o=s(r,"user-scalable"),a=s(r,"initial-scale"),l=s(r,"maximum-scale");if(o&&o.length>1&&("0"==o[1]||"no"==o[1].toLowerCase()))return!1;if(a&&l)return!(a.length>1&&l.length>1&&1==parseFloat(a[1])&&1==parseFloat(l[1]))}return!0}return!0}return!1},u=utils._getBrowserNameAndVersion(s),c=function(){i.browser.name=u.name,i.browser.version=u.version,i.browser.actualVersion=r(i.browser.name,i.browser.version),i.os.name=o(s,i.isMobile),i.os.version=a(s,i.isMobile)},p=function(){i.isZoomable=l(),i.isReady=!0,i.browserReady.fire()},h=function(){c()};if(i.isMobile)if(i.isIos||""===i.servUrl||i.isTablet||i.isWinPhone)h(),p();else{var d,f=function(t){var e=JSON.parse(t);i.browser.name=e.browser.name,i.browser.version=i.browser.actualVersion=e.browser.version,i.os.name=e.os.name,i.os.version=e.os.version,i.isMobile=e.isMobile,i.isTablet=e.isTablet,p()};if(sessionStorage&&!t){var m=sessionStorage;d=sessionStorage.getItem("ACS_BROWSER")}if(d)f(d);else{var g=function(t){m&&m.setItem("ACS_BROWSER",t),f(t)},v=function(){h(),p()},y=function(){var t=new Date,e=t.getFullYear().toString(),i=(t.getMonth()+1).toString(),s=t.getDate().toString();return e+(i[1]?i:"0"+i[0])+(s[1]?s:"0"+s[0])},b=function(){return utils.hashCode(y()+"ForeSee"+(location.origin||"null"))},w={method:"GET",url:i.servUrl+b()+"&ua="+s,type:"*/*",contentType:"application/x-www-form-urlencoded",success:g,failure:v};new utils.AjaxTransport(w,!0).send()}}else c(),i.isReady=!0,i.isIE="IE"==i.browser.name,i.browserReady.fire()},utils._unsupportedDevice=function(t){for(var e in UNSUPPORTED_DEVICES)if(t.match(UNSUPPORTED_DEVICES[e]))return!0},utils._getBrowserNameAndVersion=function(t){var e,i,s="Unknown";return null!==(i=t.match(/Opera[\/\s](\d+\.\d+)/))?s="Opera":null!==(i=t.match(/Edge\/([0-9\.]*)/))?s="IE":null!==(i=t.match(/opr[\/\s](\d+\.\d+)/i))?s="Opera":null!==(i=t.match(/Windows Phone[\/\s](\d+\.\d+)/))?s="IEMobile":null!==(i=t.match(/MSIE (\d+\.\d+)/))?s="IE":null!==(i=t.match(/Navigator[\/\s](\d+\.\d+)/))?s="Netscape":null!==(i=t.match(/Chrome[\/\s](\d+\.\d+)/))?s="Chrome":null!==(i=t.match(/Version\/([0-9\.]*)[\w\W]*Safari/i))?s="Safari":null!==(i=t.match(/Firefox[\/\s](\d+\.\d+)/))?s="Firefox":null!==(i=t.match(/googlebot/gi))?(s="Chrome",e=44):Object.hasOwnProperty.call(window,"ActiveXObject")&&!window.ActiveXObject&&(s="IE",e=11),{name:s,version:e||(null!==i?parseFloat(i[1]):void 0)}},utils.Cookie=function(t){this.opts=t||{}},utils.Cookie.prototype.set=function(t,e,i){var s=this.opts;i&&(s=utils.ext({},s,i));var n=s.domain;e=utils.isDefined(s.encode)?encodeURIComponent(e):e,t=encodeURIComponent(t),n&&("localhost"==n||n.indexOf("192.")>-1||n.indexOf("127.")>-1)&&delete s.domain;for(var r in s)if(s[r]){var o=s[r];switch(e+=";"+("duration"===r?"expires":r),r){case"duration":e+="="+new Date(utils.now()+o*utils.FULL_DAY).toGMTString();break;default:e+="="+o}}var a=t+"="+e;document.cookie=a},utils.Cookie.prototype.get=function(t){var e=document.cookie.match("(?:^|;)\\s*"+utils.escapeRegExp(t)+"=([^;]*)");return e?decodeURIComponent(e[1]):null},utils.Cookie.prototype.kill=function(t){var e=new Date;e.setTime(e.getTime()-9999),this.set(t,"",{expires:e})},utils.AjaxTransport=function(t){var e={method:"POST",data:{},contentType:"application/x-www-form-urlencoded",success:function(){},failure:function(){}};this.options=utils.ext(e,t)},utils.AjaxTransport.prototype.send=function(t){var e=utils.ext(this.options,t||{});window.XDomainRequest?this._sendViaXDR(e):window.XMLHttpRequest&&this._sendViaXHR(e),e=null},utils.AjaxTransport.prototype.dispose=function(){utils.superDispose(this.options)},utils.AjaxTransport.initialize=function(t){t.call(utils.AjaxTransport)},utils.AjaxTransport.prototype._sendViaXHR=function(t){var e=new window.XMLHttpRequest,i=utils.isDefined(t.skipEncode)&&t.skipEncode===!0?t.data:utils.toQueryString(t.data,null,!1),s=t.url+"";"GET"==t.method&&i&&i.length>0&&(i=i.replace("?",""),s+=s.indexOf("?")>-1?"&":"?",s+=i);try{e.open(t.method,s,!0)}catch(n){return}e.setRequestHeader("Accept","*/*"),e.setRequestHeader("Content-Type",t.contentType),e.onreadystatechange=function(t,e){return function(){4==e.readyState&&200==e.status?t.success&&t.success.apply(t,[e.responseText]):4==e.readyState&&200!=e.status&&t.failure&&t.failure.apply(t,[e.responseText])}}(t,e),e.send(i)},utils.AjaxTransport.prototype._sendViaXDR=function(t){var e=utils.isDefined(t.skipEncode)&&t.skipEncode===!0?t.data:utils.toQueryString(t.data,null,!1),i=t.url;t.failure=t.failure||function(){},"GET"==t.method&&e&&e.length>0&&(e=e.replace("?",""),i+=i.indexOf("?")>-1?"&":"?",i+=e);var s=new window.XDomainRequest;if(t.contentType)try{s.contentType=t.contentType}catch(n){}s.onerror=t.failure,s.ontimeout=t.failure,s.onprogress=function(){},s.onload=function(t,e){return function(){e.success(t.responseText),t=null,e=null}}(s,t),s.timeout=3e4;try{s.open(t.method,i)}catch(n){return void(t.failure&&t.failure(n))}s.send(e)};var FrameTracker=function(){this._state={},this.tabs=-1,this.tabCountChanged=new utils.FSEvent,this._tm=setInterval(utils.proxy(function(){var t=new Date,e=0;for(var i in this._state)t-parseInt(this._state[i])>3e3?delete this._state[i]:e++;e!=this.tabs&&(this.tabs=e,this.tabCountChanged.fire(e))},this),1e3)};FrameTracker.prototype.registerFrameHB=function(t){this._sync(),this._state["_"+t]=(new Date).getTime(),this._sync(this._state)},FrameTracker.prototype._sync=function(t){t?(localStorage.setItem("_fsFTHB",JSON.stringify(t)),this._state=t):this._state=JSON.parse(localStorage.getItem("_fsFTHB")||"{}")},utils.Bind(window,"load",function(t){var e=new utils.Browser;e.browserReady.subscribe(function(){var t=new FrameController(e),i="";setInterval(utils.proxy(function(){var e=t.cm.get("acsTrackerAlive"),s=t.cm.get("trackerinit");e&&e!=i&&(i=e,t._postMessage("trackerhb",e)),s&&(t._postMessage("trackermsg",JSON.stringify({initReceived:"true"})),t.cm.kill("trackerinit"))},this),250)},!0,!0)});